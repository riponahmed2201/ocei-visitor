(function(a,b){if("function"==typeof define&&define.amd)define(function(a){var c;try{c=a("jquery")}catch(a){}return b(c,a("blobjs"),a("file-saverjs"),a("xlsx"))});else if("object"==typeof exports&&"string"!=typeof exports.nodeName){var c;try{c=require("jquery")}catch(a){}module.exports=b(c,require("blobjs"),require("file-saverjs"),require("xlsx"))}else a.TableExport=b(a.jQuery,a.Blob,a.saveAs,a.XLSX)})(this,function(a,b,c,d){"use strict";function e(){for(var a=arguments,b=1;b<a.length;b++)for(var c in a[b])a[b].hasOwnProperty(c)&&(a[0][c]=a[b][c]);return a[0]}function f(a){return"undefined"==typeof a.length?[].concat(a):[].slice.call(a)}function g(a,b){return 0<b.filter(function(b){return-1!==[].indexOf.call(document.querySelectorAll(b),a)}).length}function h(a){return"undefined"!=typeof a}function i(a){return a instanceof Array?[].concat.apply([],a):a}function j(a){return~t.indexOf(a)}function k(a){var b;return b=a===s.TXT||a===s.CSV||a===s.XLS||r(a),b}function l(a){return console.error(a),new Error(a)}function m(a,b,c){var d={};return a?(d.bootstrapClass=b[0]+" ",d.bootstrapTheme=b[1]+" ",d.bootstrapSpacing=b[2]+" "):(d.bootstrapClass=c+" ",d.bootstrapTheme="",d.bootstrapSpacing=""),d}var n=function(a,b){var c=this;if(!a)return l("\"selectors\" is required. \nUsage: TableExport(selectors, options)");if(!c)return new n(a,b);c.settings=e({},c.defaults,b),c.selectors=f(a);var d=c.settings;d.ignoreRows=d.ignoreRows instanceof Array?d.ignoreRows:[d.ignoreRows],d.ignoreCols=d.ignoreCols instanceof Array?d.ignoreCols:[d.ignoreCols],d.ignoreCSS=c.ignoreCSS instanceof Array?c.ignoreCSS:[c.ignoreCSS],d.emptyCSS=c.emptyCSS instanceof Array?c.emptyCSS:[c.emptyCSS],d.formatValue=c.formatValue.bind(this,d.trimWhitespace),d.bootstrapSettings=m(d.bootstrap,c.bootstrapConfig,c.defaultButton);var g={};c.getExportData=function(){return g},c.selectors.forEach(function(a){var b={};b.rows=f(a.querySelectorAll("tbody > tr")),b.rows=d.headers?f(a.querySelectorAll("thead > tr")).concat(b.rows):b.rows,b.rows=d.footers?b.rows.concat(f(a.querySelectorAll("tfoot > tr"))):b.rows,b.thAdj=d.headers?a.querySelectorAll("thead > tr").length:0,b.filename="id"===d.filename?a.getAttribute("id")||c.defaultFilename:d.filename||c.defaultFilename,b.sheetname="id"===d.sheetname?a.getAttribute("id")||c.defaultSheetname:d.sheetname||c.defaultSheetname,b.uuid=v(a),b.checkCaption=function(b){var e=a.querySelectorAll("caption."+c.defaultCaptionClass);e.length?e[0].appendChild(b):(e=document.createElement("caption"),e.className=d.bootstrapSettings.bootstrapSpacing+c.defaultCaptionClass,e.style.cssText="caption-side: "+d.position,e.appendChild(b),a.insertBefore(e,a.firstChild))},b.setExportData=function(){return function(a){var c=o.getInstance().getItem(a),d=a.substring(a.indexOf("-")+1);g[b.uuid]=g[b.uuid]||{},g[b.uuid][d]=JSON.parse(c)}}(),b.rcMap=new p().build(b,d);var e=t.reduce(function(a,b){return a[b]=0,a},{});d.formats.forEach(function(a){return j(a)?k(a)?void(e[a]||(b.setExportData(c.exporters.build.call(c,b,a)),e[a]++)):l("\""+a+"\" requires \"js-xlsx\"."):l("\""+a+"\" is not a valid format. \nFormats: "+t.join(", "))})});var h=document.querySelectorAll("button["+c.storageKey+"]");return x(h,"click",c.downloadHandler,c),c};n.prototype={version:"5.2.0",defaults:{headers:!0,footers:!0,formats:["xlsx","csv","txt"],filename:"id",bootstrap:!1,exportButtons:!0,position:"bottom",ignoreRows:null,ignoreCols:null,trimWhitespace:!0,RTL:!1,sheetname:"id"},CONSTANTS:{FORMAT:{XLSX:"xlsx",XLSM:"xlsm",XLSB:"xlsb",BIFF2:"biff2",XLS:"xls",CSV:"csv",TXT:"txt"},TYPE:{STRING:"s",NUMBER:"n",BOOLEAN:"b",DATE:"d"}},charset:"charset=utf-8",defaultFilename:"myDownload",defaultSheetname:"myWorksheet",defaultButton:"button-default",defaultCaptionClass:"tableexport-caption",defaultNamespace:"tableexport-",tableKey:"tableexport-key",storageKey:"tableexport-id",ignoreCSS:".tableexport-ignore",emptyCSS:".tableexport-empty",bootstrapConfig:["btn","btn-default","btn-toolbar"],rowDel:"\r\n",entityMap:{"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47;"},formatConfig:{xlsx:{defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"},xlsm:{defaultClass:"xlsm",buttonContent:"Export to xlsm",mimeType:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",fileExtension:".xlsm"},xlsb:{defaultClass:"xlsb",buttonContent:"Export to xlsb",mimeType:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",fileExtension:".xlsb"},xls:{defaultClass:"xls",buttonContent:"Export to xls",separator:"\t",mimeType:"application/vnd.ms-excel",fileExtension:".xls",enforceStrictRFC4180:!1},csv:{defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"text/csv",fileExtension:".csv",enforceStrictRFC4180:!0},txt:{defaultClass:"custom-btn txt",buttonContent:"Download",separator:"|",mimeType:"text/plain",fileExtension:".txt",enforceStrictRFC4180:!0}},typeConfig:{string:{defaultClass:"tableexport-string"},number:{defaultClass:"tableexport-number",assert:function(a){return!isNaN(a)}},boolean:{defaultClass:"tableexport-boolean",assert:function(a){return"true"===a.toLowerCase()||"false"===a.toLowerCase()}},date:{defaultClass:"tableexport-date",assert:function(a){return!/.*%/.test(a)&&!isNaN(Date.parse(a))}}},exporters:{build:function(a,b){var c=this,d=c.settings,e=c.formatConfig[b],g=e.separator,h=a.rcMap,i=function(a){return r(b)?{v:d.formatValue(a.textContent),t:c.getType(a.className)}:b===s.CSV?"\""+d.formatValue(a.textContent.replace(/"/g,"\"\""))+"\"":d.formatValue(a.textContent)},j=f(a.rows).map(function(a,c){if(h.isIgnore(c))return h.handleRowColMapProp(h.TYPE.IGNORE);if(h.isEmpty(c))return h.handleRowColMapProp(h.TYPE.EMPTY);var d=a.querySelectorAll("th, td");return f(d).map(function(a,d){var e=i(a);return h.isIgnore(c,d)?h.handleRowColMapProp(h.TYPE.IGNORE):h.isEmpty(c,d)?h.handleRowColMapProp(h.TYPE.EMPTY):h.handleRowColMapProp(h.TYPE.DEFAULT,c,d,b,e,g)}).processCols(b,g)}).processRows(b,c.rowDel),k=JSON.stringify({data:j,filename:a.filename,mimeType:e.mimeType,fileExtension:e.fileExtension,merges:h.merges,RTL:d.RTL,sheetname:d.sheetname}),l=w({uuid:a.uuid,type:b});return d.exportButtons&&a.checkCaption(c.createObjButton(l,k,e.buttonContent,e.defaultClass,d.bootstrapSettings)),o.getInstance().setItem(l,k,!0)}},createObjButton:function(a,b,c,d,e){var f=document.createElement("button");return f.setAttribute("type","button"),f.setAttribute(this.storageKey,a),f.className=e.bootstrapClass+e.bootstrapTheme+d,f.textContent=c,f},escapeHtml:function(a){var b=this;return(a+"").replace(/[&<>'\/]/g,function(a){return b.entityMap[a]})},unescapeHtml:function(a){var b=a+"";for(var c in this.entityMap)b=b.replace(RegExp(this.entityMap[c],"g"),c);return b},formatValue:function(a,b){return a?b.trim():b},getType:function(a){if(!a)return"";var b=this.typeConfig;return~a.indexOf(b.string.defaultClass)?u.STRING:~a.indexOf(b.number.defaultClass)?u.NUMBER:~a.indexOf(b.boolean.defaultClass)?u.BOOLEAN:~a.indexOf(b.date.defaultClass)?u.DATE:""},dateNum:function(a,b){b&&(a+=1462);var c=Date.parse(a),d=(c-new Date(Date.UTC(1899,11,30)))/86400000;return Math.floor(d)},createSheet:function(a,b){for(var c={},e={s:{c:1e7,r:1e7},e:{c:0,r:0}},f=this.typeConfig,g=0;g!==a.length;++g)for(var h=0;h!==a[g].length;++h){e.s.r>g&&(e.s.r=g),e.s.c>h&&(e.s.c=h),e.e.r<g&&(e.e.r=g),e.e.c<h&&(e.e.c=h);var i=a[g][h];if(i&&i.v){var j=d.utils.encode_cell({c:h,r:g});i.t||(f.number.assert(i.v)?i.t=u.NUMBER:f.boolean.assert(i.v)?i.t=u.BOOLEAN:f.date.assert(i.v)?i.t=u.DATE:i.t=u.STRING),i.t===u.DATE&&(i.t=u.NUMBER,i.z=d.SSF._table[14],i.v=this.dateNum(i.v)),c[j]=i}}return c["!merges"]=b,1e7>e.s.c&&(c["!ref"]=d.utils.encode_range(e)),c},downloadHandler:function(a){var b=a.target,c=JSON.parse(o.getInstance().getItem(b.getAttribute(this.storageKey))),d=c.data,e=c.filename,f=c.mimeType,g=c.fileExtension,h=c.merges,i=c.RTL,j=c.sheetname;this.export2file(d,f,e,g,h,i,j)},Workbook:function(){this.Workbook={Views:[]},this.SheetNames=[],this.Sheets={}},string2ArrayBuffer:function(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!==a.length;++d)c[d]=255&a.charCodeAt(d);return b},export2file:function(a,c,d,e,f,g,h){var i=e.slice(1);if(a=this.getRawData(a,e,d,f,g,h),q&&(i===s.CSV||i===s.TXT)){var j="data:"+c+";"+this.charset+","+a;this.downloadDataURI(j,d,e)}else window.saveAs(new b([a],{type:c+";"+this.charset}),d+e,!0)},downloadDataURI:function(a,b,c){var d=encodeURI(a),e=document.createElement("a");e.setAttribute("href",d),e.setAttribute("download",b+c),document.body.appendChild(e),e.click()},getBookType:function(a){return a===s.XLS?s.BIFF2:a},getRawData:function(a,b,c,e,f,g){var h=b.substring(1);if(r(h)){var i=new this.Workbook,j=this.createSheet(a,e),k=this.getBookType(h);g=g||"",i.SheetNames.push(g),i.Sheets[g]=j,i.Workbook.Views[0]={RTL:f};var l=d.write(i,{bookType:k,bookSST:!1,type:"binary"});a=this.string2ArrayBuffer(l)}return a},getFileSize:function(a,b){var c=this.getRawData(a,b);return c instanceof ArrayBuffer?c.byteLength:this.string2ArrayBuffer(c).byteLength},update:function(a){return this.remove(),new n(this.selectors,e({},this.defaults,a))},reset:function(){return this.remove(),new n(this.selectors,this.settings)},remove:function(){var a=this;this.selectors.forEach(function(b){var c=b.querySelector("caption."+a.defaultCaptionClass);c&&b.removeChild(c)})}};var o=function(){this._instance=null,this.store=sessionStorage,this.namespace=n.prototype.defaultNamespace,this.getKey=function(a){return this.namespace+a},this.setItem=function(a,b,c){var d=this.getKey(a);if(!this.exists(a)||c)return"string"==typeof b?(this.store.setItem(d,b),a):l("\"value\" must be a string.")},this.getItem=function(a){var b=this.getKey(a);return this.store.getItem(b)},this.exists=function(a){var b=this.getKey(a);return null!==this.store.getItem(b)},this.removeItem=function(a){var b=this.getKey(a);return this.store.removeItem(b)}};o.getInstance=function(){return this._instance||(this._instance=new o),this._instance};var p=function(){this.rcMap=[],this.merges=[],this.isIgnore=function(a,b){var c=p.prototype.TYPE.IGNORE;return this.getRowColMapProp(a,b,c)},this.isEmpty=function(a,b){var c=p.prototype.TYPE.EMPTY;return this.getRowColMapProp(a,b,c)},this.isRowSpan=function(a){var b=p.prototype.TYPE.ROWSPAN;return this.getRowColMapProp(a,void 0,b)},this.isColSpan=function(a){var b=p.prototype.TYPE.COLSPAN;return this.getRowColMapProp(a,void 0,b)},this.isSpan=function(a){return this.isRowSpan(a)||this.isColSpan(a)},this.isMerge=function(){return 0<this.merges.length},this.addMerge=function(a,b){var c=p.prototype.TYPE.MERGE;this.merges.push(b),this.setRowColMapProp(a,void 0,c,this.merges)},this.getRowColMapProp=function(a,b,c){if(this.rcMap[a]){if("undefined"==typeof c)return this.rcMap[a][b];if("undefined"==typeof b)return this.rcMap[a][c];if(this.rcMap[a][b])return this.rcMap[a][b][c]}},this.setRowColMapProp=function(a,b,c,d){return this.rcMap[a]=this.rcMap[a]||[],"undefined"==typeof c?this.rcMap[a][b]=d:"undefined"==typeof b?this.rcMap[a][c]=d:(this.rcMap[a][b]=this.rcMap[a][b]||[],this.rcMap[a][b][c]=d)},this.generateTotal=function(a,b){var c=p.prototype.TYPE.VALUE,d=0;return this.isRowSpan(a)&&this.isColSpan(a)?d=this.getRowColMapProp(a,b,c)||0:this.getRowColMapProp(a,b,c)&&(d=this.getRowColMapProp(a,b,c)),d},this.convertSpanToArray=function(a,b,c,d,e){if(this.rcMap[a]&&this.isSpan(a)){var f=this.generateTotal(a,b);return r(c)?Array(f).concat(d):Array(f).concat(d).join(e)}return d},this.handleRowColMapProp=function(a,b,c,d,e,f){switch(a){case p.prototype.TYPE.IGNORE:return;case p.prototype.TYPE.EMPTY:return" ";case p.prototype.TYPE.DEFAULT:default:return this.convertSpanToArray(b,c,d,e,f);}}};p.prototype={OFFSET:1,TYPE:{IGNORE:"ignore",EMPTY:"empty",MERGE:"merge",ROWSPAN:"rowspan",ROWSPANTOTAL:"rowspantotal",COLSPAN:"colspan",COLSPANTOTAL:"colspantotal",DEFAULT:"default",VALUE:"value"},build:function(a,b){var c=this,d=c.OFFSET,e=c.rowLength=a.rows.length,h=function(a,b){c.setRowColMapProp(a,b,c.TYPE.IGNORE,!0)},i=function(a,b){c.setRowColMapProp(a,b,c.TYPE.EMPTY,!0)},j=function(a,b,d){for(var f,g,h,j,m,n,o,p,q,r=+a.getAttribute("rowspan"),s=+a.getAttribute("colspan"),t=0;t<r;t++){if(t+b>=e)return;if(s&&(f=k(a,t+b,d,0<t,r)),1>=r)return!1;var u=c.rcMap["c"+(d-1)]?c.rcMap["c"+(d-1)][t+b]:0;if(u&&(c.rcMap["c"+d]=c.rcMap["c"+d]||[],c.rcMap["c"+d][t+b]=(c.rcMap["c"+d][t+b]||0)+u),r&&0===t&&1<s)for(var v=0;v<r;v++)c.rcMap["c"+(d+1)]=c.rcMap["c"+(d+1)]||[],c.rcMap["c"+(d+1)][t+b+v]=(c.rcMap["c"+(d+1)][t+b+v]||0)+Math.max(1,s);if(1<=t&&(g=c.getRowColMapProp(t+b,void 0,c.TYPE.ROWSPAN)||0,c.setRowColMapProp(t+b,void 0,c.TYPE.ROWSPAN,g+1),!f&&(j=c.getRowColMapProp(t+b,d-g,c.TYPE.VALUE)||0,c.setRowColMapProp(t+b,d-g,c.TYPE.VALUE,j+1),1<r&&1===t))){var w=c.rcMap["c"+d]&&c.rcMap["c"+d][t+b];m=c.getRowColMapProp(b,void 0,c.TYPE.COLSPANTOTAL)||0,h=c.getRowColMapProp(b,void 0,c.TYPE.COLSPAN)||0,n=b,o=b+r-1,p=d+m-h+(w||0),q=p+Math.max(1,s)-1,l(n,p,o,q)}}},k=function(a,b,e,f,g){var h,i,j,k,m=+a.getAttribute("colspan"),n=c.getRowColMapProp(b,void 0,c.TYPE.COLSPAN)||0,o=c.getRowColMapProp(b,void 0,c.TYPE.COLSPANTOTAL)||0;return!(1>=m)&&(c.setRowColMapProp(b,void 0,c.TYPE.COLSPAN,n+1),c.setRowColMapProp(b,void 0,c.TYPE.COLSPANTOTAL,o+m),f?(c.setRowColMapProp(b,e-n,c.TYPE.VALUE,m),!0):void(h=b,i=b+(g||1)-d,j=e+o-n,k=e+o-n+(m-d),c.setRowColMapProp(b,e+d,c.TYPE.VALUE,m-d),l(h,j,i,k)))},l=function(a,b,d,e){return c.addMerge(a,{s:{r:a,c:b},e:{r:d,c:e}})};return f(a.rows).map(function(c,d){(!!~b.ignoreRows.indexOf(d-a.thAdj)||g(c,b.ignoreCSS))&&h(d),g(c,b.emptyCSS)&&i(d);var e=c.querySelectorAll("th, td");return f(e).map(function(a,c){(!!~b.ignoreCols.indexOf(c)||g(a,b.ignoreCSS))&&h(d,c),g(a,b.emptyCSS)&&i(d,c),a.hasAttribute("rowspan")?j(a,d,c):a.hasAttribute("colspan")&&k(a,d,c)})}),c}};var q=function(a){return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substring(0,4))}(navigator.userAgent||navigator.vendor||window.opera),r=function(){return function(a){return d&&!n.prototype.formatConfig[a].enforceStrictRFC4180}}(),s=function(){return n.prototype.CONSTANTS.FORMAT}(),t=function(){return Object.keys(s).map(function(a){return s[a]})}(),u=function(){return n.prototype.CONSTANTS.TYPE}();Object.defineProperty(Array.prototype,"processRows",{enumerable:!1,value:function(a,b){return r(a)?this.map(i).filter(h):this.filter(h).join(b)}}),Object.defineProperty(Array.prototype,"processCols",{enumerable:!1,value:function(a,b){return r(a)?this.filter(h):this.filter(h).join(b)}});var v=function(){var a=0;return function(b){var c=b.getAttribute(n.prototype.tableKey);return c||(c=b.id?b.id:n.prototype.defaultNamespace+ ++a,b.setAttribute(n.prototype.tableKey,c)),c}}(),w=function(){return function(a){var b,c,d=0,e=a.type;if(a=JSON.stringify(a),0===a.length)return d;for(b=0;b<a.length;b++)c=a.charCodeAt(b),d=(d<<5)-d+c,d|=0;return d.toString(16).substring(1)+"-"+e}}(),x=function(){var a=null;return function(b,c,d,e){for(var f=d.bind(e),g=0;g<b.length;++g)a&&b[g].removeEventListener(c,a,!1),b[g].addEventListener(c,f,!1);a=f}}();if(a)for(var y in a.fn.tableExport=function(b){return n.call(e({},n.prototype,a.fn.tableExport),this,b)},n.prototype)a.fn.tableExport[y]=n.prototype[y];return n.TableExport=n,n});