var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(a){"use strict";if(!("undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=a.URL||a.webkitURL||a,e=b.createElementNS("http://www.w3.org/1999/xhtml","a"),f=!a.externalHost&&"download"in e,g=a.webkitRequestFileSystem,h=a.requestFileSystem||g||a.mozRequestFileSystem,i=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},j=0,k=[],l=function(){for(var a,b=k.length;b--;)a=k[b],"string"==typeof a?d.revokeObjectURL(a):a.remove();k.length=0},m=function(a,b,c){b=[].concat(b);for(var d,e=b.length;e--;)if(d=a["on"+b[e]],"function"==typeof d)try{d.call(a,c||a)}catch(a){i(a)}},n=function(d,i){var l,n,o,p=this,q=d.type,r=!1,s=function(){var a=c().createObjectURL(d);return k.push(a),a},t=function(){m(p,["writestart","progress","write","writeend"])},u=function(){if((r||!l)&&(l=s(d)),n)n.location.href=l;else{if(navigator.userAgent.match(/7\.[\d\s\.]+Safari/)&&"undefined"!=typeof window.FileReader&&157286400>=d.size){var a=new window.FileReader;return a.readAsDataURL(d),a.onloadend=function(){var c=b.createElement("iframe");return c.src=a.result,c.style.display="none",b.body.appendChild(c),void t()},p.readyState=p.DONE,void(p.savedAs=p.SAVEDASUNKNOWN)}return window.open(l,"_blank"),p.readyState=p.DONE,p.savedAs=p.SAVEDASBLOB,void t()}},v=function(a){return function(){if(p.readyState!==p.DONE)return a.apply(this,arguments)}},w={create:!0,exclusive:!1};if(p.readyState=p.INIT,i||(i="download"),f){l=s(d),b=a.document,e=b.createElementNS("http://www.w3.org/1999/xhtml","a"),e.href=l,e.download=i;var x=b.createEvent("MouseEvents");return x.initMouseEvent("click",!0,!1,a,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(x),p.readyState=p.DONE,p.savedAs=p.SAVEDASBLOB,void t()}return a.chrome&&q&&"application/octet-stream"!==q&&(o=d.slice||d.webkitSlice,d=o.call(d,0,d.size,"application/octet-stream"),r=!0),g&&"download"!==i&&(i+=".download"),("application/octet-stream"===q||g)&&(n=a),h?void(j+=d.size,h(a.TEMPORARY,j,v(function(a){a.root.getDirectory("saved",w,v(function(a){var b=function(){a.getFile(i,w,v(function(a){a.createWriter(v(function(b){b.onwriteend=function(b){n.location.href=a.toURL(),k.push(a),p.readyState=p.DONE,p.savedAs=p.SAVEDASBLOB,m(p,"writeend",b)},b.onerror=function(){var a=b.error;a.code!==a.ABORT_ERR&&u()},["writestart","progress","write","abort"].forEach(function(a){b["on"+a]=p["on"+a]}),b.write(d),p.abort=function(){b.abort(),p.readyState=p.DONE,p.savedAs=p.FAILED},p.readyState=p.WRITING}),u)}),u)};a.getFile(i,{create:!1},v(function(a){a.remove(),b()}),v(function(a){a.code===a.NOT_FOUND_ERR?b():u()}))}),u)}),u)):void u()},o=n.prototype,p=function(a,b){return new n(a,b)};return o.abort=function(){var a=this;a.readyState=a.DONE,a.savedAs=a.FAILED,m(a,"abort")},o.readyState=o.INIT=0,o.WRITING=1,o.DONE=2,o.FAILED=-1,o.SAVEDASBLOB=1,o.SAVEDASURI=2,o.SAVEDASUNKNOWN=3,o.error=o.onwritestart=o.onprogress=o.onwrite=o.onabort=o.onerror=o.onwriteend=null,a.addEventListener("unload",l,!1),p.unload=function(){l(),a.removeEventListener("unload",l,!1)},p}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd?define([],function(){return saveAs}):"undefined"!=typeof Meteor&&(Meteor.saveAs=saveAs);